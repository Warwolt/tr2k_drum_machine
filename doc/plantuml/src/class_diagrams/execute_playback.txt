@startuml

skinparam linetype ortho

title Execute Playback


''' Class definitions '''

Package "Presentation"
{
	class PlaybackPositionView
	{
		handlePlaybackStep()
	}
}

Package "Application"
{
	class PatternEditController
	{
		getSelectedInstrumentId() : Integer
	}
}

Package "Domain"
{
	Package "Playback"
	{
		class PlaybackTimingManager
		{
			handlePlayback()
		}

		interface PlaybackTimingSubscriber
		{
			handlePlaybackStep()
		}

		class InstrumentPlaybackManager
		{
			handlePlaybackStep()
		}

		interface TempoTimer
		{
			playbackStepIsDue() : Boolean
		}

		class PlaybackActionManager
		{
			executePlaybackAction(InstrumentId)
		}
	}

	Package "Pattern"
	{
		class RhythmPatternManager
		{
			currentStepActiveInPattern(InstrumentId) : Boolean
			advanceAllPlaybackPositions()
		}
	}
}

Package "HardwareAbstractionLayer"
{
	class LedGroup
	{
		blinkLed(ledNum : Integer)
	}
}

''' Class relations '''

PlaybackTimingManager --> TempoTimer
PlaybackTimingManager --> PlaybackTimingSubscriber

PlaybackTimingSubscriber <|.. InstrumentPlaybackManager
PlaybackTimingSubscriber <|.. PlaybackPositionView

InstrumentPlaybackManager -left-> RhythmPatternManager
InstrumentPlaybackManager --> PlaybackActionManager

PlaybackPositionView --> PatternEditController
PlaybackPositionView --> LedGroup

@enduml
